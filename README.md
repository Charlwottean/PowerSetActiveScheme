# PowerSetActiveScheme
;Author: JScript - Snippet Version No. = 1.0 ;Snippet was Created Using AutoIt Version = 3.3.8.1, Creation Date = 20/08/12. ;Sets power active scheme (only Vista-Seven)  ; PowerSave Global $PWR_SAVE = "{a1841308-3541-4fab-bc81-f71556f20b4a}" ; Balanced Global $PWR_BALANCED = "{381b4222-f694-41f0-9685-ff5bb260df2e}" ; High Performance Global $PWR_HIGH = "{8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c}"  _PowerSetActiveScheme($PWR_HIGH)  ; #FUNCTION# ==================================================================================================================== ; Name ..........: _PowerSetActiveScheme ; Description ...: Sets power active scheme. ; Syntax ........: _PowerSetActiveScheme($sPwrValue) ; Parameters ....: $sPwrValue        - Power Scheme, a string value. ; Return values .: Success             - 1 ;                 Failure             - 0 ; Author ........: JScript ; Modified ......: ; Remarks .......: ; Related .......: ; Link ..........: ; Example .......: _PowerSetActiveScheme($PWR_HIGH) ; High Performance ; =============================================================================================================================== Func _PowerSetActiveScheme($sGUID)     Local $aiRet, $tGUID, $pGUID      $tGUID = DllStructCreate("ulong Data1;ushort Data2;ushort Data3;byte Data4[8]") ; $tagGUID in StructureConstants.au3!     $pGUID = DllStructGetPtr($tGUID)      DllCall("ole32.dll", "long", "CLSIDFromString", "wstr", $sGUID, "ptr", $pGUID)     If @error Then Return SetError(0, @extended, 0)      ; DWORD WINAPI PowerSetActiveScheme(__in_opt  HKEY UserRootPowerKey,    __in      const GUID *SchemeGuid);     $aiRet = DllCall('PowrProf.dll', "int", 'PowerSetActiveScheme', 'ptr', 0, 'ptr', $pGUID)     ;If $aiRet[0] > 0 Then SetError(2, @extended, 0)      Return 1 EndFunc   ;==>_PowerSetActiveScheme
